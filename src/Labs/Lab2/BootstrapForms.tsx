//TODO: section 3.3.10 to 3.3.15